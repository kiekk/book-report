### 기본 엔진엑스 구성

```
엔진엑스 구성 파일은 하나의 논리적인 구조로 조직된 지시어의 목록으로 이뤄져 있고, 이러한 지시어에 정의한 값으로 애플리케이션의 전체 동작을 정의한다.
지시어는 항상 세미콜론(;)으로 끝나야 한다.
```

#### 구조와 포함
`include`

```
include 지시어는 이름 그대로 지정한 파일을 인클루드시킵니다.
지시어가 있는 곳에 포함될 파일의 내용이 삽입됩니다.
인클루드된 문서가 또 다른 문서를 인클루드하는 것도 가능합니다.
```

```
nginx.conf 파일
    user nginx nginx;
    worker_process 4;
    include other_settings.conf;

other_settings.conf 파일
    error_log logs/error.log;
    pid logs/nginx.pid;
    
==== 결과
nginx.conf 파일
    user nginx nginx;
    worker_process 4;
    error_log logs/error.log;
    pid logs/nginx.pid;
```

##### 기본 제공되는 표준 파일명
|표준 파일명| 설명                                                    |
|---|-------------------------------------------------------|
|nginx.conf| 웹 서버의 기본 구성                                           |
|mime.types| 파일 확장자와 연관된 MIME 타입의 목록                               |
|fastcgi_params| Fast CGI 관련 구성                                        |
|proxy.conf| 프록시 관련 구성                                             |
|sites.conf| 엔진엑스로 제공되는 웹 사이트(가상 호스트) 구성.<br/>도메인 단위로 분리하기를 권장합니다. |

```
include 지시어에 지정한 파일이 없을 때는 구성 확인에 실패하고 엔진엑스가 시작하지 않기 때문에 파일을 인클루드할 때 주의해야 합니다.

include dummyfile.conf로 존재하지 않는 dummyfile.conf를 포함시키려고 하면 에러가 발생합니다.
include dummy*.conf처럼 와일드카드로 파일을 포함시킬 때는 일치하는 파일이 있든 없든 검증을 통과합니다.   
```

#### 지시어 블록
`
event {
    worker_connections 1024;
}
`

```
어떤 모듈이 활성화되면 모듈 내에 있는 지시어도 따라서 활성화되는데, 이때 지시어 블록도 활성화됩니다.
모듈이 활성화한 지시어는 해당 모듈의 블록에서만 사용할 수 있습니다.
위처럼 worker_connections 지시어는 event 블록 안에서만 유효합니다.
반면 서버 전반에 영향을 미치는 지시어는 반드시 어떤 블록에도 속하지 않은 구성의 최상위에 위치해야 합니다.
이러한 구성 파일의 최상위 수준을 main 블록이라고 합니다.
```

#### 고급 언어 규칙

`rewrite ^/(.*)\.(png|jpg|gif|$ /image.php? file=$1$format=$2 last;`

```
root 지시어는 간단한 문자열만을 받는 반면,
location이나 rewrite 같은 지시어는 특정 패턴에 일치시키고자 복잡한 식(정규식)을 지원합니다.
```

#### 지시어 값의 축약

```
파일 크기, 시간을 지정하는 지시어 값으로 다음과 같은 축약을 사용할 수 있습니다.
```

| 축약     | 단위   |
|--------|------|
| k or K | 킬로바이트 |
| m or M | 메가바이트 |
| g or G | 기가바이트 |
| ms     | 밀리초  |
| s      | 초    |
| m      | 분    |
| h      | 시간   |
| d      | 일    |
| w      | 주    |
| M      | 달    |
| y      | 년    |

```
client_body_timeout 1m30s;
client_body_timeout '1m 30s 500ms';

위와 같이 서로 다른 단위의 값을 결합하는 것도 가능한데,
두 번쨰 구문처럼 값을 띄어쓰기로 구분할 때는 따옴표로 묶어야 합니다.
```

#### 변수

```
모듈은 지시어 값을 정의할 때 사용할 수 있는 변수를 제공합니다.
엔진엑스의 변수는 항상 $ 표시로 시작합니다.
★일부 지시어는 변수를 사용할 수 없습니다.
```

#### 문자열 값
```
공백이나 세미콜론(;) 또는 중괄호({}) 같은 특수문자를 쓰고 싶을 때는 역슬래시(\)를 문자 앞에 붙이거나, 전체 문자열을 작은따옴표나 큰따옴표로 묶어야 합니다.
★엔진엑스에서는 작은따옴표나 큰따옴표는 아무런 차이가 없습니다.
★ $앞에 역슬래시(\)를 붙이면 변수로 사용되지 않고 문자열로 적용됩니다.
```